# Jacobi Method using CUDA
Calculate the Jacobi Method using CUDA for parallel programming course at UoA

## JacobiCuda:
Για τον υπολογισμό του Jacobi μέσω CUDA με μία GPU το πρόγραμμα διαβάζει το input
και δεσμέυει την απαραίτητη μνήμη στην GPU με την συνάρτηση βιβλιοθήκης cudaMalloc()
για τους πίνακες uc,uc_old με μέγεθος (n+2)\*(m+2). Ομοίως, δεσμεύεται μνήμη για τις
μεταβλητές της συνάρτησης Jacobi. Ο αριθμός των νημάτων υπολογίζεται διαιρώντας τον
αριθμό των datapoints διά 500 και προσθέτοντας 1. Με αυτή την υλοποίηση φτιάχνουμε τον
κατάλληλο αριθμό blocks για την εκτέλεση του Jacobi. Οπότε, δεσμεύεται πίνακας
f_error\[BLOCK_NUM\*500\], αρχικοποιώντας τις τιμές μέσω cudaMemcpy(). Στη συνέχεια
εκτελείται η one_jacobi_iteration() με BLOCK_NUM\*500 threads, όπου ένα thread για κάθε
σειρά. Στην συνάρτηση αυτή το πρόγραμμα εκτελεί τον αλγόριθμο Jacobi για κάθε σειρά,
αναθέτοντας στο y την τιμή blockDim.x\*blockIdx.x+threadIdx.x, δηλαδή την τοποθεσία του
thread στο συγκεκριμένο block και αποθηκεύοντας το τελικό error στην αντίστοιχη θέση του
πίνακα f_error. Τέλος, ο πίνακας f_error αντιγράφεται στην CPU, όπου και υπολογίζεται το
άθροισμα των τιμών του.
Για δύο GPU η υλοποίηση είναι παρόμοια με μία, με την διαφορά ότι δεσμεύεται
μνήμη για δύο uc,uc_old πίνακες πρακτικά χωρίζοντας τον κεντρικό πίνακα στη μέση, καθώς
και για δύο πίνακες f_error\[BLOCK_NUM\*500\], όπου BLOCK_NUM ίσο με (size/2)/500 για την
προσθήκη των καινούριων στηλών halo points. Κατά την εκτέλεση της κεντρικής while καλείται
η συνάρτηση createhalo, η οποία εκτελείται σε GPU με σκοπό την μεταφορά των δεδομένων
στα καινούρια halo points. Αφότου γίνει αυτό, για cudaSetDevice(0) καλείται η
one_jacobi_iteration() με BLOCK_NUM\*500 νήματα και ομοίως με μία GPU αντιγράφουμε τις
τιμές του πίνακα στην CPU. Ύστερα καλούμε την cudaSetDevice(1) και την
one_jacobi_iteration() συγχρονίζοντας τις δύο συσκευές.

## Χρόνοι:
![image](https://user-images.githubusercontent.com/75782840/148710245-2e26da9a-0816-4f45-822b-2a18668541cc.png)
![image](https://user-images.githubusercontent.com/75782840/148710257-07eaed3a-c221-4564-9fe9-969310a94b26.png)
Από τα παραπάνω δεδομένα παρατηρούμε ότι το CUDA για μεγαλύτερους αριθμούς είναι δεκάδες εως
και χιλίαδες φορές ταχύτερο α όλες τις άλλες τεχνικές, καθώς οι πράξεις εκτελούνται μέσα σε GPU που
είναι εξειδικευμένη στον υπολογισμό πράξεων, όπως αυτές του Jacobi.
